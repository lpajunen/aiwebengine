# Local Development Configuration
# This configuration is optimized for local development with verbose logging and relaxed security
# Copy this file to config.toml and customize as needed: cp config.local.toml config.toml

[server]
# Use 0.0.0.0 to be accessible from Caddy container
host = "0.0.0.0"
port = 3000
# Short timeout for quick feedback during development
request_timeout_ms = 5000
# Small body limit for development testing
max_body_size_mb = 1

[logging]
# Verbose logging for development debugging
level = "debug"
# Enable structured logging for better development experience
structured = true
# Log to both console and file in development
targets = ["console", "file"]
file_path = "./logs/aiwebengine-dev.log"
# Rotate logs daily in development
rotation = "daily"
# Keep logs for 7 days in development
retention_days = 7

[javascript]
# Small memory limit for development testing
max_memory_mb = 16
# Short execution timeout for quick feedback
execution_timeout_ms = 1000
# Small stack size for development
max_stack_size = 65536
# Enable console for development debugging
enable_console = true
# Enable all APIs for development experimentation
allowed_apis = ["fetch", "database", "logging", "filesystem"]

[repository]
# Use PostgreSQL for development (same as production/staging)
database_type = "postgresql"
# Database URL is set via environment variable: APP_REPOSITORY__DATABASE_URL
# The double underscore __ maps to the nested config: repository.database_url
# Set in .env file or export directly: export APP_REPOSITORY__DATABASE_URL="postgresql://..."
# Small connection limits for development
max_connections = 5
# Short timeout for development
connection_timeout_ms = 2000
# Enable migrations for development schema changes
auto_migrate = true

[security]
# Relaxed security for development
enable_cors = true
# Allow all origins in development
cors_origins = ["*"]
# No rate limiting in development
rate_limit_per_minute = 0
# Simple API key for development (override with APP_SECURITY_API_KEY env var)
api_key = "dev-api-key-12345"
# No HTTPS required in development
require_https = false
# Allow all content types in development
allowed_content_types = ["application/json", "application/x-www-form-urlencoded", "multipart/form-data", "text/plain"]

[performance]
# Small cache for development
cache_size_mb = 10
# Short cache TTL for development
cache_ttl_seconds = 60
# No compression in development for easier debugging
enable_compression = false
# Small worker pool for development
worker_pool_size = 2
# Small request queue for development
max_request_queue_size = 50

# Authentication Configuration
[auth]
# Enable authentication in development
enabled = true

# JWT secret for session management (minimum 32 characters)
# Override with APP_AUTH_JWT_SECRET environment variable
# For production, ALWAYS use environment variables!
jwt_secret = "dev-jwt-secret-minimum-32-characters-required-for-security"

# Session timeout in seconds (1 hour)
session_timeout = 3600

# Maximum concurrent sessions per user
max_concurrent_sessions = 10

# Bootstrap admin emails
# Users with these emails will automatically receive Administrator role on first sign-in
# This allows you to bootstrap the system with an initial admin who can then
# grant roles to other users through the /manager UI
#
# FOR LOCAL DEVELOPMENT: Add your own email here
# Example: bootstrap_admins = ["your-email@gmail.com", "another@example.com"]
#
# Note: To set via environment variable, use JSON array format:
# export APP_AUTH_BOOTSTRAP_ADMINS='["your-email@gmail.com"]'
bootstrap_admins = [
    "admin@example.com",
]

[auth.cookie]
# Cookie settings for development
name = "aiwebengine_session"
path = "/"
secure = false  # Set to true in production with HTTPS
http_only = true
same_site = "lax"

# OAuth Providers Configuration
# Configure at least one provider to enable authentication
# Set secrets via environment variables (see .env.example):
#   APP_AUTH_PROVIDERS_GOOGLE_CLIENT_ID
#   APP_AUTH_PROVIDERS_GOOGLE_CLIENT_SECRET
#   APP_AUTH_PROVIDERS_GOOGLE_REDIRECT_URI

[auth.providers.google]
client_id = "${APP_AUTH_PROVIDERS_GOOGLE_CLIENT_ID}"
client_secret = "${APP_AUTH_PROVIDERS_GOOGLE_CLIENT_SECRET}"
redirect_uri = "http://localhost:3000/auth/callback/google"
scopes = ["openid", "email", "profile"]

# Optional: Microsoft Azure AD
# Uncomment and set via environment variables to enable
# [auth.providers.microsoft]
# client_id = "${APP_AUTH_PROVIDERS_MICROSOFT_CLIENT_ID}"
# client_secret = "${APP_AUTH_PROVIDERS_MICROSOFT_CLIENT_SECRET}"
# redirect_uri = "http://localhost:3000/auth/callback/microsoft"
# tenant_id = "common"  # or your tenant ID
# scopes = ["openid", "email", "profile"]

# Optional: Apple Sign In
# Uncomment and set via environment variables to enable
# [auth.providers.apple]
# client_id = "${APP_AUTH_PROVIDERS_APPLE_CLIENT_ID}"
# client_secret = "${APP_AUTH_PROVIDERS_APPLE_CLIENT_SECRET}"
# redirect_uri = "http://localhost:3000/auth/callback/apple"
# team_id = "${APP_AUTH_PROVIDERS_APPLE_TEAM_ID}"
# key_id = "${APP_AUTH_PROVIDERS_APPLE_KEY_ID}"
# private_key = """${APP_AUTH_PROVIDERS_APPLE_PRIVATE_KEY}"""
